!function(){"use strict";angular.module("app",["app.core","app.auth","app.index","app.message","app.shell"])}(),function(){"use strict";angular.module("app.auth",["app.core","ui.bootstrap"])}(),function(){"use strict";angular.module("app.core",["core.helpers","core.router"])}(),function(){"use strict";angular.module("app.index",["app.core"])}(),function(){"use strict";angular.module("app.shell",["app.auth","app.core"])}(),function(){"use strict";angular.module("app.message",["app.core"])}(),function(){"use strict";angular.module("core.helpers",[])}(),function(){"use strict";angular.module("core.router",["ui.router"])}(),Object.defineProperty(Object.prototype,"extend",{value:function(e){var t=Object.hasOwnProperty,r=Object.create(this);for(var n in e)e[n]&&(t.call(e,n)||"undefined"==typeof r[n])&&(r[n]=e[n]);return r}}),function(){"use strict";function e(e){e.interceptors.push("tokenInterceptor")}angular.module("app.auth").config(e),e.$inject=["$httpProvider"]}(),function(){"use strict";angular.module("app.auth").constant("jwt_decode",jwt_decode)}(),function(){"use strict";function e(e,t,r){function n(e){function r(t){return e.headers["x-access-token"]=t.data.accessToken,e}function n(){return o()}function o(){var r=t.defer();return e.timeout=r.promise,r.resolve(),e}return 0!==e.url.indexOf("/api")||e.url.indexOf("/api/v0/auth")>-1?e:e.headers["x-access-token"]?e:s.accessTokenIsExpired()?a.refresh().then(r,n):(e.headers["x-access-token"]=s.getAccessToken(),e)}function o(e){return e.error===-1&&(e.data.message="Your request could not be processed."),t.reject(e)}var a,s;return r(function(){a=e.get("authService"),s=e.get("userService")}),{request:n,responseError:o}}angular.module("app.auth").factory("tokenInterceptor",e),e.$inject=["$injector","$q","$timeout"]}(),function(){"use strict";function e(e){e.configureStates(t())}function t(){return[{state:"login",config:{url:"/login",params:{message:void 0,messageType:"bg-danger",redirectState:"message"},data:{authModal:!0}}},{state:"reset",config:{url:"/reset?token&email",templateUrl:"app/auth/reset.html",controller:"ResetCtrl",controllerAs:"rc"}},{state:"verify",config:{url:"/verify?token&email",templateUrl:"app/auth/verify.html",controller:"VerifyCtrl",controllerAs:"vc",resolve:{verification:["authService","$q","$state","$stateParams","$timeout",function(e,t,r,n,o){function a(e){return o(function(){r.go("login",{message:"Your account has been verified. Login to continue.",messageType:"bg-success"})}),e}function s(){return{message:"Provided token was invalid. Check your e-mail for a link, or resend an e-mail below."}}var u=n.email,i=n.token;return u&&i?e.verify(u,i).then(a,s):{message:"Please verify your account. Check your e-mail for a link, or resend an e-mail below."}}]}}}]}angular.module("app.auth").run(e),e.$inject=["routerHelper"]}(),function(){"use strict";function e(e,t,r,n,o,a){function s(){function t(e){return e}function r(t){return e.reject(t)}return a.getRefreshToken()?a.accessTokenIsExpired()?n.refresh().then(t,r):(a.refreshUser(),e.resolve({})):e.reject({})}s(),t.$on("$stateChangeStart",function(e,t,n,a){t.data&&t.data.authModal&&(""===a.name&&r.go("index"),"login"===t.name&&(e.preventDefault(),o.openModal(n).result.then(function(){r.go(n.redirectState)},function(){})))}),t.$on("$stateChangeStart",function(e,t){function n(){r.go("login",{message:"Please login.",messageType:"bg-danger",redirectState:t.name})}if(t.data&&t.data.requiresAuth)return a.getRefreshToken()?a.accessTokenIsExpired?void s().then(null,n):a.refreshUser():(e.preventDefault(),n())})}angular.module("app.auth").run(e),e.$inject=["$q","$rootScope","$state","authService","loginModalService","userService"]}(),function(){"use strict";function e(e,t,r,n,o){function a(r,o,a){function s(e){return e}function u(e){return t.reject(e)}var i={email:r,token:o,password:a};return e.post(n.auth+"/change",i).then(s,u)}function s(r){function o(e){return e}function a(e){return t.reject(e)}var s={email:r};return e.post(n.auth+"/forgot",s).then(o,a)}function u(r,a){function s(e){return o.setRefreshToken(e.data.refreshToken),o.setAccessToken(e.data.accessToken),e}function u(e){return t.reject(e)}var i={email:r,password:a};return e.post(n.auth+"/login",i).then(s,u)}function i(a,s){function u(e){return o.destroyTokens(),a&&r.go(a,s),e}function i(e){return t.reject(e)}var c={headers:{"x-refresh-token":o.getRefreshToken()}};return e.post(n.auth+"/logout",void 0,c).then(u,i)}function c(){function r(e){return o.setAccessToken(e.data.accessToken),e}function a(e){return e.status!==-1&&o.destroyTokens(),t.reject(e)}var s={headers:{"x-refresh-token":o.getRefreshToken()}};return e.post(n.auth+"/refresh",void 0,s).then(r,a)}function l(r,o){function a(e){return e}function s(e){return t.reject(e)}var u={email:r,password:o};return e.post(n.auth+"/register",u).then(a,s)}function g(r){function o(e){return e}function a(e){return t.reject(e)}var s={email:r};return e.post(n.auth+"/resend",s).then(o,a)}function f(r,o){function a(e){return e}function s(e){return t.reject(e)}var u={email:r,token:o};return e.post(n.auth+"/verify",u).then(a,s)}var d=this;d.change=a,d.forgot=s,d.login=u,d.logout=i,d.refresh=c,d.register=l,d.resend=g,d.verify=f}angular.module("app.auth").service("authService",e),e.$inject=["$http","$q","$state","api","userService"]}(),function(){"use strict";function e(e,t,r,n,o){function a(t){function r(e){return i.forgotAlert.message="Password reset link has been sent to the e-mail.",i.forgotAlert.type="bg-success",e}function o(t){switch(i.forgotAlert.type="bg-danger",t.status){case 401:i.forgotAlert.message="E-mail doesn't exist.";break;default:i.forgotAlert.message="Something went wrong, please try again."}return e.reject(t)}return n.forgot(t).then(r,o)}function s(o,a){function s(e){return r.close(),e}function u(n){switch(i.loginAlert.type="bg-danger",n.status){case 401:i.loginAlert.message="E-mail or password is invalid, please try again.";break;case 403:r.dismiss(),t.go("verify",{email:o});break;default:i.loginAlert.message="Something went wrong, please try again."}return e.reject(n)}return n.login(o,a).then(s,u)}function u(t,r){function o(e){return i.registerAlert.message="Account has been registered. Please check your e-mail for a verification link.",i.registerAlert.type="bg-success",e}function a(t){switch(i.registerAlert.type="bg-danger",t.status){case 401:i.registerAlert.message="Must enter a valid e-mail and password.";break;case 409:i.registerAlert.message="E-mail already exists.";break;default:i.registerAlert.message="Something went wrong, please try again."}return e.reject(t)}return n.register(t,r).then(o,a)}var i=this;i.forgot=a,i.forgotAlert={message:void 0,type:void 0},i.login=s,i.loginAlert={message:o.message,type:o.messageType},i.register=u,i.registerAlert={message:void 0,type:void 0},i.modalInstance=r}angular.module("app.auth").controller("LoginModalCtrl",e),e.$inject=["$q","$state","$uibModalInstance","authService","params"]}(),function(){"use strict";function e(e,t){function r(e){return n.modal=t.open({templateUrl:"/app/auth/login-modal.html",controller:"LoginModalCtrl",controllerAs:"lmc",resolve:{params:function(){return e}}}),n.modal.result["finally"](function(){n.modal=void 0}),n.modal}var n=this;n.modal=void 0,n.openModal=r}angular.module("app.auth").service("loginModalService",e),e.$inject=["$rootScope","$uibModal"]}(),function(){"use strict";function e(e,t,r,n){function o(o){function s(e){return t.go("login",{message:"Password was changed. Please login.",messageType:"bg-success"}),e}function u(t){switch(a.alert.type="bg-danger",t.status){case 401:a.alert.message="E-mail or reset token was invalid.";break;default:a.alert.message="Something went wrong when trying to change your password."}return e.reject(t)}return n.change(r.email,r.token,o).then(s,u)}var a=this;a.alert={message:void 0,type:void 0},a.change=o}angular.module("app.auth").controller("ResetCtrl",e),e.$inject=["$q","$state","$stateParams","authService"]}(),function(){"use strict";function e(e,t){function r(){var e=c.getAccessToken();if(!e)return!0;var r=t(e);return Date.now()>=1e3*r.exp-3e4}function n(){c.user=void 0,e.localStorage.removeItem("accessToken"),e.localStorage.removeItem("refreshToken")}function o(){return e.localStorage.getItem("accessToken")}function a(){return e.localStorage.getItem("refreshToken")}function s(e){var r=e||c.getAccessToken();if(r)return c.user=t(r)}function u(r){return c.user=t(r),e.localStorage.setItem("accessToken",r),r}function i(t){return e.localStorage.setItem("refreshToken",t),t}var c=this;c.accessTokenIsExpired=r,c.destroyTokens=n,c.getAccessToken=o,c.getRefreshToken=a,c.refreshUser=s,c.setAccessToken=u,c.setRefreshToken=i,c.user=void 0}angular.module("app.auth").service("userService",e),e.$inject=["$window","jwt_decode"]}(),function(){"use strict";function e(e,t,r,n){function o(){function t(e){return a.alert.message="Please check your e-mail for a verification link.",a.alert.type="bg-success",e}function n(t){switch(a.alert.type="bg-danger",t.status){case 401:a.alert.message="E-mail invalid or does not exist.";break;default:a.alert.message="Something went wrong when trying to resend the e-mail."}return e.reject(t)}return r.resend(a.email).then(t,n)}var a=this;a.alert={message:n.message,type:"bg-danger"},a.email=t.email,a.resend=o}angular.module("app.auth").controller("VerifyCtrl",e),e.$inject=["$q","$stateParams","authService","verification"]}(),function(){"use strict";function e(){var e="/api/v0";return{auth:e+"/auth"}}angular.module("app.core").constant("api",e())}(),function(){"use strict";function e(e){var r="/";e.configureStates(t(),r)}function t(){return[]}angular.module("app.core").run(e),e.$inject=["routerHelper"]}(),function(){"use strict";function e(e){e.defaults.cache=!1}angular.module("app.core").run(e),e.$inject=["$http"]}(),function(){"use strict";function e(){}angular.module("app.index").controller("IndexCtrl",e),e.$inject=[]}(),function(){"use strict";function e(e){e.configureStates(t())}function t(){return[{state:"index",config:{url:"/",templateUrl:"app/index/index.html",controller:"IndexCtrl",controllerAs:"ic"}}]}angular.module("app.index").run(e),e.$inject=["routerHelper"]}(),function(){"use strict";function e(e,t,r){function n(){return t.logout("index")}var o=this;o.logout=n,o.user=r.user,e.$watch(function(){return r.user},function(e){o.user=e})}angular.module("app.shell").controller("HeaderCtrl",e),e.$inject=["$scope","authService","userService"]}(),function(){"use strict";function e(e){function t(){e.get("/api/v0/msg/random").then(function(e){r.msg=e.data.message},function(){r.msg="something went wrong"})}var r=this;r.test=t,r.msg="No message yet."}angular.module("app.message").controller("MessageCtrl",e),e.$inject=["$http"]}(),function(){"use strict";function e(e){e.configureStates(t())}function t(){return[{state:"message",config:{url:"/message",templateUrl:"app/message/message.html",controller:"MessageCtrl",controllerAs:"mc",data:{requiresAuth:!0}}}]}angular.module("app.message").run(e),e.$inject=["routerHelper"]}(),function(){"use strict";function e(){function e(e,t){t.replaceWith(t.children())}return{require:"ngInclude",restrict:"A",link:e}}angular.module("core.helpers").directive("mhIncludeReplace",e)}(),function(){"use strict";function e(e,t,r){function n(e,n,a){function s(e,n){e.forEach(function(e){e.config.resolve=angular.extend(e.config.resolve||{},o.resolveAlways),t.state(e.state,e.config)}),n&&!f&&(f=!0,r.otherwise(n))}function u(){n.$on("$stateChangeError",function(t,r,n,o,a,s){if(!g){d.errors++,g=!0;var u=r&&(r.title||r.name||r.loadedTemplateUrl)||"unknown target",i="Error routing to "+u+". "+(s.data||"")+". <br/>"+(s.statusText||"")+": "+(s.status||"");i+="",e.path("/")}})}function i(){u(),l()}function c(){return a.get()}function l(){n.$on("$stateChangeSuccess",function(e,t){d.changes++,g=!1;var r=o.docTitle+" "+(t.title||"");n.title=r})}var g=!1,f=!1,d={errors:0,changes:0},p={configureStates:s,getStates:c,stateCounts:d};return i(),p}var o={docTitle:void 0,resolveAlways:{}};e.html5Mode(!0),this.configure=function(e){angular.extend(o,e)},this.$get=n,n.$inject=["$location","$rootScope","$state"]}angular.module("core.router").provider("routerHelper",e),e.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"]}();